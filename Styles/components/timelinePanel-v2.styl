// Status Panel Component V2
// 貨件狀態面板組件 V2

@import 'variables'

.status-panel-v2
  width 100%
  max-width 1200px
  background base-white
  border-radius 16px
  box-shadow panel-shadow
  padding 40px 48px
  display flex
  flex-direction column
  gap 32px
  position relative
  z-index 2

  .status-title
    font-size 1.75rem
    font-weight 600
    color primary-color
    margin 0

  .timeline-container
    position relative
    padding 100px 0

  .timeline-track
    position absolute
    top 41%
    left 0
    right 0
    height 4px
    background neutral-light
    transform translateY(-50%)
    border-radius 2px

  .timeline-progress
    position absolute
    top 0
    left 0
    height 100%
    background linear-gradient(90deg, primary-color 0%, accent-color 100%)
    border-radius 2px
    width 0
    transition width 1.5s cubic-bezier(0.65, 0, 0.35, 1)
    
    // 當可見時觸發動畫
    &.animate
      transition width 1.5s cubic-bezier(0.65, 0, 0.35, 1)

  .timeline-nodes
    position relative
    display flex
    justify-content space-between
    align-items center
    z-index 1

  .timeline-event
    position absolute
    top -60px
    transform translateX(-50%)
    display flex
    flex-direction column
    align-items center
    gap 8px
    z-index 10

    .event-icon
      font-size 28px 
      animation float 3s ease-in-out infinite

    .event-bubble
      position relative
      background base-white
      color primary-color
      font-size 0.75rem
      font-weight 600
      padding 8px 14px
      border-radius 8px
      white-space nowrap
      box-shadow 0 4px 12px shadow
      border 2px solid accent-color

      &::after
        content ''
        position absolute
        top 100%
        left 50%
        transform translateX(-50%)
        width 0
        height 0
        border-left 8px solid transparent
        border-right 8px solid transparent
        border-top 8px solid accent-color

      &::before
        content ''
        position absolute
        top 100%
        left 50%
        transform translateX(-50%)
        width 0
        height 0
        border-left 6px solid transparent
        border-right 6px solid transparent
        border-top 6px solid base-white
        z-index 1
        margin-top -2px

  .timeline-event-icon
    position absolute
    top 50%
    transform translate(-50%, -50%)
    z-index 5
    background #97d3df
    border-radius 50%
    width 35px
    height 35px
    display flex
    align-items center
    justify-content center
    box-shadow 0 2px 8px rgba(0, 0, 0, 0.15)
    cursor default

    &.scale-up
      transform translate(-50%, -50%) scale(1.3)
      background #97d3df
      box-shadow 0 4px 16px shadow-secondary

    img
      width 70%
      height auto
      display block
      object-fit contain
      filter brightness(0) invert(1) 

  .timeline-node
    position relative
    display flex
    flex-direction column
    align-items center
    justify-content flex-start
    width 40px
    z-index 2

    .node-dot
      width 40px
      height 40px
      border-radius 50%
      background neutral-light
      box-shadow 0 2px 8px rgba(0, 0, 0, 0.1)
      transition all 0.3s ease
      position relative
      z-index 2
      display flex
      align-items center
      justify-content center

    &.scale-up .node-dot
      transform scale(1.3)
      box-shadow 0 4px 16px rgba(0, 0, 0, 0.2)

    .node-icon
      position relative
      font-size 1.2rem
      font-weight 400
      color base-white
      opacity 1
      margin-top 2px
      transition opacity 0.3s ease
      z-index 3

    .node-datetime
      display flex
      flex-direction column
      align-items center
      margin-top 10px
      text-align center
      
      .datetime-month
        font-size 0.65rem
        font-weight 600
        letter-spacing 0.05em
        line-height 1
        margin-bottom 2px
        
      .datetime-day
        font-size 1.5rem
        font-weight 700
        line-height 1
        margin-bottom 2px
        
      .datetime-time
        font-size 0.7rem
        font-weight 500
        line-height 1

    &.completed
      .node-dot
        background primary-color
        box-shadow 0 2px 12px shadow

      .node-icon
        color base-white
        
      .node-datetime
        .datetime-month,
        .datetime-day,
        .datetime-time
          color primary-color

    &.active
      .node-dot
        background accent-color
        box-shadow 0 0 0 0 rgba(accent-color, 0.7),
                   0 0 0 8px rgba(accent-color, 0.4),
                   0 0 0 16px rgba(accent-color, 0.2),
                   0 0 20px rgba(accent-color, 0.5)
        animation radiate 2s ease-out infinite

      .node-icon
        color base-white
        
      .node-datetime
        .datetime-month,
        .datetime-day,
        .datetime-time
          color accent-color

    &.pending
      .node-dot
        background neutral-light

      .node-icon
        color base-white
        
      .node-datetime
        .datetime-month,
        .datetime-day,
        .datetime-time
          color neutral-light

  .timeline-cards
    position absolute
    width 100%
    display flex
    justify-content space-between
    align-items center
    left 0
    padding 0 2%

    &.top
      top -80px
      z-index 10

    &.bottom
      bottom -80px
      z-index 10

  .timeline-card
    background base-white
    border-radius 8px
    display flex
    flex-direction row
    align-items center
    padding 12px 16px
    gap 8px
    transition all 0.3s ease
    position relative
    box-shadow 0 2px 8px rgba(0, 0, 0, 0.1)
    white-space nowrap

    // 上方卡片的連接線
    &.top::after
      content ''
      position absolute
      top 100%
      left 50%
      transform translateX(-50%)
      width 1px
      height 20px
      background neutral-light
      transition background-color 0.3s ease

    // 下方卡片的連接線
    &.bottom::after
      content ''
      position absolute
      bottom 100%
      left 50%
      transform translateX(-50%)
      width 1px
      height 20px
      background neutral-light
      transition background-color 0.3s ease

    // 已完成的步驟直接顯示白底藍邊框效果
    &.completed
      background #fff
      border 1px solid #143463
      
      .card-number
        color #143463
        background #fff
        border-color #143463
      
      .card-title
        color #143463
      
      .card-time
        color #143463

      // 已完成的卡片連接線效果
      &.top::after
        background-color #143463
      
      &.bottom::after
        background-color #143463

      // Step1 特定位置調整
      &[data-step="1"].top::after
        left 17%

      // Step2 特定位置調整
      &[data-step="2"].bottom::after
        left 76%

      // Step3 特定位置調整
      &[data-step="3"].top::after
        left 34%

      // Step4 特定位置調整
      &[data-step="4"].bottom::after
        left 95%

      // Step5 特定位置調整
      &[data-step="5"].top::after
        left 46%

      // Step6 特定位置調整
      &[data-step="6"].bottom::after
        left 96%

      // Step7 特定位置調整
      &[data-step="7"].top::after
        left 78%

      // Step9 特定位置調整
      &[data-step="9"].top::after
        left 85.5% !important
        transform translateX(-50%) !important

    // 為 pending 狀態的 Step9 也添加相同的位置調整
    &.pending[data-step="9"].top::after
      left 85.5% !important
      transform translateX(-50%) !important

    // 乾冰卡片 pending 狀態（半透明效果）
    &.event.pending
      opacity 0.2
      background #97d3df
      
      .card-icon-wrapper
        .card-icon-img
          filter brightness(0) invert(1)
      
      .card-title
        color base-white
      
      .card-time
        color base-white
      
      // Event 卡片的連接線效果
      &.top::after
        background-color #97d3df
      
      &.bottom::after
        background-color #97d3df
        left 92%
        height 90px

    &:hover
      background primary-color
      
      .card-number
        color primary-color
        background base-white
        border-color base-white
      
      .card-title
        color base-white
      
      .card-time
        color base-white

    // 上方卡片的 hover 連接線效果
    &.top:hover::after
      background-color primary-color
    
    // 下方卡片的 hover 連接線效果
    &.bottom:hover::after
      background-color primary-color

    // 乾冰卡片固定顯示完成效果（淺藍底白字）
    &.event,
    &.event.highlight
      background #97d3df
      box-shadow 0 4px 16px shadow-secondary
      
      .card-icon-wrapper
        .card-icon-img
          filter brightness(0) invert(1)
      
      .card-title
        color base-white
      
      .card-time
        color base-white
      
      // Event 卡片的連接線效果
      &.top::after
        background-color #97d3df
      
      &.bottom::after
        background-color #97d3df
        left 92%
        height 90px

    &.completed.highlight
      background primary-color

      .card-number
        color primary-color
        background base-white
        border-color base-white

      .card-title
        color base-white

      .card-time
        color base-white
      
      // Completed 卡片的 highlight 連接線效果
      &.top::after
        background-color primary-color
      
      &.bottom::after
        background-color primary-color

    &.active
      background accent-color
      box-shadow 0 4px 16px shadow-accent

      .card-number
        color accent-color
        background base-white
        border-color base-white

      .card-title
        color base-white

      .card-time
        color base-white
      
      // Active 卡片的固定連接線效果
      &.top::after
        background-color accent-color
      
      &.bottom::after
        background-color accent-color
        left 15%

    .card-number
      width 36px
      height 36px
      border-radius 50%
      border 1px solid neutral-light
      background base-white
      color accent-color
      font-size 1.2rem
      font-weight 700
      display flex
      align-items center
      justify-content center
      flex-shrink 0

    .card-icon
      width 36px
      height 36px
      font-size 1.8rem
      display flex
      align-items center
      justify-content center
      flex-shrink 0
      align-self flex-start

    .card-icon-wrapper
      display flex
      align-items center
      justify-content flex-start
      padding 0
      flex-shrink 0
      align-self flex-start

    .card-icon-img
      width 35px
      height 35px
      object-fit contain

    .card-content
      display flex
      flex-direction column
      gap 6px

    .card-title
      font-size 0.9rem
      font-weight 600
      color neutral-gray
      line-height 1.3
      text-align left

    .card-time
      font-size 0.8rem
      color neutral-gray
      line-height 1.2
      text-align left

    &.completed
      .card-number
        color primary-color

    &.active
      background accent-color
      box-shadow 0 4px 16px shadow-accent

      .card-number
        color accent-color
        background base-white
        border-color base-white
        animation pulse-card 2s infinite

      .card-title
        color base-white

      .card-time
        color base-white

    &.pending
      opacity 0.6
      cursor not-allowed
      pointer-events none

      .card-number
        color neutral-light
        border-color neutral-light

      .card-title
        color neutral-light

      .card-time
        color neutral-light

    &.event
      .card-icon
        color accent-color

// Animations
@keyframes pulse
  0%
    transform scale(1)
    opacity 0.6
  50%
    transform scale(1.3)
    opacity 0.3
  100%
    transform scale(1)
    opacity 0.6

@keyframes glow
  0%, 100%
    box-shadow 0 2px 16px shadow-accent-strong
  50%
    box-shadow 0 2px 24px shadow-accent-glow

@keyframes float
  0%, 100%
    transform translateY(0)
  50%
    transform translateY(-8px)

@keyframes pulse-card
  0%, 100%
    transform scale(1)
  50%
    transform scale(1.05)

@keyframes shimmerLast
  0%
    right 15%
    opacity 0.3
  50%
    right 7.5%
    opacity 1
  100%
    right 0
    opacity 0.3

@keyframes pulseScale
  0%, 50%
    transform scale(1)
  75%
    transform scale(1.3)
  100%
    transform scale(1)

@keyframes radiate
  0%
    box-shadow 0 0 0 0 rgba(accent-color, 0.7),
               0 0 0 0 rgba(accent-color, 0.4),
               0 0 0 0 rgba(accent-color, 0.2),
               0 0 20px rgba(accent-color, 0.5)
  50%
    box-shadow 0 0 0 4px rgba(accent-color, 0.5),
               0 0 0 12px rgba(accent-color, 0.3),
               0 0 0 20px rgba(accent-color, 0.1),
               0 0 25px rgba(accent-color, 0.6)
  100%
    box-shadow 0 0 0 0 rgba(accent-color, 0),
               0 0 0 8px rgba(accent-color, 0),
               0 0 0 16px rgba(accent-color, 0),
               0 0 20px rgba(accent-color, 0.5)

// Desktop Specific Styles
@media (min-width: 769px)
  .status-panel-v2
    .timeline-track
      top 41%
      transform translateY(-50%)

    .timeline-progress
      background linear-gradient(90deg, primary-color 0%, accent-color 100%)

    .timeline-nodes
      flex-direction row
      justify-content space-between

    .timeline-event-icon
      // 固定在步驟 7-8 之間
      left 80%
      top 41%
      transform translate(-50%, -50%)

    .timeline-cards
      position absolute
      width 100%
      display flex
      justify-content space-around
      align-items center
      left 0
      padding 0 2%

      &.top
        top 120px
        z-index 10

      &.bottom
        bottom 50px
        z-index 10

    .timeline-card
      padding 12px 16px
      background base-white
      box-shadow 0 2px 8px rgba(0, 0, 0, 0.1)
      gap 8px
      position relative

      &.event
        .card-icon-img
          &.icon-default
            display block

          &.icon-hover
            display none

// Mobile Specific Styles
@media (max-width: 768px)
  .status-panel-v2
    padding 32px 20px

    .status-title
      font-size 1.2rem
      margin-bottom 8px

    .timeline-container
      display flex
      flex-direction column
      position relative
      padding 0
      padding-left 21px

    .timeline-track
      position absolute
      top 0
      left 20px
      width 4px
      height 100%
      transform none
      background neutral-light

    .timeline-progress
      width 100%
      height 87.5%
      background linear-gradient(180deg, primary-color 0%, accent-color 100%)

    .timeline-nodes
      flex-direction column
      gap 32px
      align-items flex-start
      grid-column 1
      margin 0
      padding 0
      display none

    .timeline-node
      position relative
      left 0
      transform none
      pointer-events none
      margin 0

      &:hover
        .node-dot
          transform none

    .timeline-event-icon
      display none

    .timeline-labels
      flex-direction column
      gap 32px
      margin-top 0
      margin-bottom 0
      width 100%
      position relative
      z-index 2

    .timeline-row
      display flex
      text-align left
      flex-direction column
      gap 32px
      margin 0
      width 100%

    .timeline-card
      padding 0
      background transparent
      box-shadow none
      gap 8px
      min-height 40px
      height 40px
      display flex
      flex-direction row
      align-items flex-start
      width 100%
      pointer-events none
      margin 0
      margin-left -21px

      &:hover
        background transparent
        box-shadow none

        .card-title,
        .card-time
          color inherit

      &.completed
        .card-number
          width 42px
          height 42px
          background primary-color
          color base-white

        .card-title
          color primary-color

        .card-time
          color neutral-gray

      &.active
        background transparent
        box-shadow none

        .card-number
          width 42px
          height 42px
          background accent-color
          color base-white

        .card-title
          color accent-color

        .card-time
          color neutral-gray

      &.pending
        opacity 1

        .card-number
          width 42px
          height 42px
          background neutral-light
          color base-white

        .card-title
          color neutral-light

        .card-time
          color neutral-light

      &.event
        .card-icon-wrapper
          display flex
          justify-content center
          align-items center
          background secondary-color
          border-radius 50%
          width 42px
          height 42px
          margin-right 10px

        .card-icon-img
          width 32px
          height 32px

          &.icon-default
            display none

          &.icon-hover
            display block

        .card-title
          color secondary-color

        .card-time
          color neutral-gray

      .card-number
        display flex
        margin-right 10px

      .card-title
        font-size 1.2rem
        line-height 1.1

      .card-icon-wrapper
        display none


